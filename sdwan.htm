
<!-- saved from url=(0030)https://dannyjung.de/sdwan.htm -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252"><meta name="color-scheme" content="light dark"></head><body><div class="line-gutter-backdrop"></div><form autocomplete="off"><label class="line-wrap-control">Line wrap<input type="checkbox" aria-label="Line wrap"></label></form><table><tbody><tr><td class="line-number" value="1"></td><td class="line-content"><span class="html-doctype">&lt;!DOCTYPE html&gt;</span></td></tr><tr><td class="line-number" value="2"></td><td class="line-content"><span class="html-tag">&lt;html <span class="html-attribute-name">xmlns</span>="<span class="html-attribute-value">http://www.w3.org/1999/xhtml</span>"&gt;</span></td></tr><tr><td class="line-number" value="3"></td><td class="line-content"><span class="html-tag">&lt;head&gt;</span></td></tr><tr><td class="line-number" value="4"></td><td class="line-content">	<span class="html-tag">&lt;title&gt;</span>Map SD-WAN Sites<span class="html-tag">&lt;/title&gt;</span></td></tr><tr><td class="line-number" value="5"></td><td class="line-content">	<span class="html-tag">&lt;link <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://openlayers.org/en/v4.6.5/css/ol.css" rel="noreferrer noopener">https://openlayers.org/en/v4.6.5/css/ol.css</a>" <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text/css</span>"&gt;</span></td></tr><tr><td class="line-number" value="6"></td><td class="line-content">	<span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://openlayers.org/en/v4.6.5/build/ol.js" rel="noreferrer noopener">https://openlayers.org/en/v4.6.5/build/ol.js</a>" <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text/javascript</span>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="7"></td><td class="line-content">	<span class="html-tag">&lt;script&gt;</span></td></tr><tr><td class="line-number" value="8"></td><td class="line-content">		var map,mapLat = 40,mapLng = 0,mapDefaultZoom = 2.5;</td></tr><tr><td class="line-number" value="9"></td><td class="line-content">		function initialize_map(){</td></tr><tr><td class="line-number" value="10"></td><td class="line-content">		map=new ol.Map({</td></tr><tr><td class="line-number" value="11"></td><td class="line-content">		target:"map",</td></tr><tr><td class="line-number" value="12"></td><td class="line-content">		layers:[new ol.layer.Tile({source:new ol.source.OSM({url:"https://a.tile.openstreetmap.org/{z}/{x}/{y}.png"})})],</td></tr><tr><td class="line-number" value="13"></td><td class="line-content">		view:new ol.View({center:ol.proj.fromLonLat([mapLng,mapLat]),zoom:mapDefaultZoom})});}</td></tr><tr><td class="line-number" value="14"></td><td class="line-content">		function add_map_point(lat,lng,label) {</td></tr><tr><td class="line-number" value="15"></td><td class="line-content">			var vectorLayer = new ol.layer.Vector({</td></tr><tr><td class="line-number" value="16"></td><td class="line-content">			source:new ol.source.Vector({features:[new ol.Feature({geometry:new ol.geom.Point(ol.proj.transform([parseFloat(lng),parseFloat(lat)],'EPSG:4326','EPSG:3857')),})]}),</td></tr><tr><td class="line-number" value="17"></td><td class="line-content">			style:new ol.style.Style({image:new ol.style.Icon({anchor:[0.5,0.5],anchorXUnits:"fraction",anchorYUnits:"fraction",src:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiPjxjaXJjbGUgY3g9IjEwIiBjeT0iMTAiIHI9IjUuNjI1IiBzdHlsZT0iZmlsbDojRUExNDc2O3N0cm9rZTojMDAwO3N0cm9rZS13aWR0aDoxLjI1IiAvPjwvc3ZnPg=="}),</td></tr><tr><td class="line-number" value="18"></td><td class="line-content">			text:new ol.style.Text({text:label,offsetY:25,scale:1.3,fill:new ol.style.Fill({color:'#000'}),backgroundFill:new ol.style.Fill({color:'#ccc'})})})</td></tr><tr><td class="line-number" value="19"></td><td class="line-content">		});map.addLayer(vectorLayer)}</td></tr><tr><td class="line-number" value="20"></td><td class="line-content"><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="21"></td><td class="line-content"><span class="html-tag">&lt;/head&gt;</span></td></tr><tr><td class="line-number" value="22"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="23"></td><td class="line-content"><span class="html-tag">&lt;body <span class="html-attribute-name">onload</span>="<span class="html-attribute-value">initialize_map()</span>"&gt;</span></td></tr><tr><td class="line-number" value="24"></td><td class="line-content"><span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">map</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width: 98vw; height: 88vh;</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="25"></td><td class="line-content"><span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">btn</span>" <span class="html-attribute-name">style</span>='<span class="html-attribute-value">position:absolute;top:0;bottom:0;left:0;right:0;text-align:center;margin:auto;color:silver;font-size:10vmin;padding-top:33vh;font-family:Arial,Tahoma,Verdana,monospace;</span>'&gt;</span></td></tr><tr><td class="line-number" value="26"></td><td class="line-content"><span class="html-tag">&lt;button <span class="html-attribute-name">id</span>="<span class="html-attribute-value">Button</span>" <span class="html-attribute-name">type</span>="<span class="html-attribute-value">button</span>" <span class="html-attribute-name">onclick</span>="<span class="html-attribute-value">smxProxy.sendRequest('get-context', null, 'onContext');</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">background-color: #4CAF50;border: none;color: white;padding: .5em 1em;text-align: center;text-decoration: none;font-size: .8em;margin: .4em .2em;cursor: pointer;border-radius: .3em;box-shadow: 0px .2em .2em rgba(0, 0, 0, 0.2);</span>"&gt;</span>Map SD-WAN Sites<span class="html-tag">&lt;/button&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="27"></td><td class="line-content">	<span class="html-tag">&lt;script&gt;</span></td></tr><tr><td class="line-number" value="28"></td><td class="line-content">		function onContext(context) {</td></tr><tr><td class="line-number" value="29"></td><td class="line-content">			Gateway = context.event.objects[0]["name"];</td></tr><tr><td class="line-number" value="30"></td><td class="line-content">			smxProxy.sendRequest("request-commit", {"commands" : ["run-script script-name 'Map SD-WAN Sites' script 'base64 -id &lt;&lt;&lt; H4sIAE+Z9GMAA9VRTUsDMRC9+yseZTHuIQ322MUPUAQPavEDCrWUmN3tjo1JzKatpdv/brpiqZfehRlmmJk37w1DJSpZV1CuzpfSoHcu8mIhzFzrLFSFwXrXmhZhkssgcYy2MFHWlKgru8ywadTc64nShOSESoxGMU594eC8/Vr1yUFsx2kqpAq0KFKMxz8EhaosuAHjvJ0Fyw4BI1EAL3vgOQNrgo8J2Kth2e+i/j7eWR8ObshKSsFnUe5/v4APBw9Pz+B8+yT+Rkb6FS45OlUIru4LQY5MabtkRbBW1+JDuot479lpZ//tTcsdPfK+eN3I5QxsHcWQCUjub7DZae6w9A8yuRpc3z6K989oYF1tlQxkzZ10W5FH36KeeWlsAgAA|zcat|sh' targets.1 "+Gateway+" --format json --sync-frequency 1" ]}, "onCommit")}</td></tr><tr><td class="line-number" value="31"></td><td class="line-content">		function onCommit(value) {</td></tr><tr><td class="line-number" value="32"></td><td class="line-content">			var str = JSON.stringify(value)</td></tr><tr><td class="line-number" value="33"></td><td class="line-content">			str = str.substring(str.indexOf("responseMessage"))</td></tr><tr><td class="line-number" value="34"></td><td class="line-content">			str = str.substring(15, str.indexOf(','))</td></tr><tr><td class="line-number" value="35"></td><td class="line-content">			str = str.replace(/[^A-Za-z0-9]/g, "")</td></tr><tr><td class="line-number" value="36"></td><td class="line-content">			if ( str != "" ) {</td></tr><tr><td class="line-number" value="37"></td><td class="line-content">				document.getElementById("btn").style.display = "none";</td></tr><tr><td class="line-number" value="38"></td><td class="line-content">				for(const _ of JSON.parse(atob(str))){ add_map_point(_["loc"].substring(0,_["loc"].indexOf(',')),_["loc"].substring(_["loc"].indexOf(",")+1),_["city"].replace(/ä/g, 'ae').replace(/ö/g, 'oe').replace(/ü/g, 'ue').replace(/ß/g, 'ss').replace(/Ä/g, 'Ae;').replace(/Ö/g, 'Oe').replace(/Ü/g, 'Ue'))}}}</td></tr><tr><td class="line-number" value="39"></td><td class="line-content"><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="40"></td><td class="line-content"><span class="html-tag">&lt;/body&gt;</span></td></tr><tr><td class="line-number" value="41"></td><td class="line-content"><span class="html-tag">&lt;/html&gt;</span><span class="html-end-of-file"></span></td></tr></tbody></table></body></html>